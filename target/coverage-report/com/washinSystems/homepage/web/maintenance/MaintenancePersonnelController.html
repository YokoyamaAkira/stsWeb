<!DOCTYPE html>
<html>
<head>
  <title>MaintenancePersonnelController.java</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../../../../../coverage.css'/>
  <link rel='shortcut icon' type='image/png' href='../../../../../logo.png'/>
  <script type='text/javascript' src='../../../../../coverage.js'></script>
  <script type='text/javascript' src='../../../../../prettify.js'></script>
</head>
<body onload='prettyPrint()'>
  <table cellpadding='0' cellspacing='1'>
    <caption>washinHomePage\src\main\java\com\washinSystems\homepage\web\maintenance\MaintenancePersonnelController.java</caption>
    <tr>
      <td class='line'>1</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>package com.washinSystems.homepage.web.maintenance;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'></td><td>&nbsp;</td>
      <td><pre class='imports prettyprint' onclick='showHideLines(this)'><div>import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.validation.ObjectError;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import com.washinSystems.homepage.SecurityConfig;
import com.washinSystems.homepage.domain.CodeRole;
import com.washinSystems.homepage.domain.MaintenancePersonnel;
import com.washinSystems.homepage.domain.User;
import com.washinSystems.homepage.service.CodeRoleService;
import com.washinSystems.homepage.service.MaintenancePersonnelService;
import com.washinSystems.homepage.service.UserService;
import com.washinSystems.homepage.web.LoginUserDetails;
import com.washinSystems.homepage.web.maintenance.common.StringConstant;
import com.washinSystems.homepage.web.maintenance.formData.PersonalForm;
import com.washinSystems.homepage.web.maintenance.formData.SelectFormForRole;
</div><span>import ...</span></pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>31</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>@Controller</pre></td>
    </tr>
    <tr>
      <td class='line'>32</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>@RequestMapping("maintenance/manageSettingValues/member")</pre></td>
    </tr>
    <tr>
      <td class='line'>33</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l33s0'>public class MaintenancePersonnelController {</pre></td>
    </tr>
    <tr>
      <td class='line'>34</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@Autowired</pre></td>
    </tr>
    <tr>
      <td class='line'>35</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	CodeRoleService codeRoleService;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>37</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@Autowired</pre></td>
    </tr>
    <tr>
      <td class='line'>38</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	MaintenancePersonnelService maintenancePersonnelService;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>40</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@Autowired</pre></td>
    </tr>
    <tr>
      <td class='line'>41</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	UserService userService;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>43</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@Autowired</pre></td>
    </tr>
    <tr>
      <td class='line'>44</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	SecurityConfig securityConfig;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'></td><td>&nbsp;</td>
      <td class='comment' onclick='showHideLines(this)'><div>	/*
	 * @ModelAttribute PersonalForm setUpForm() { return new PersonalForm(); }
	 */</div><span>	/*...*/</span></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>50</td><td>&nbsp;</td>
      <td><pre class='comment'>	// in page</pre></td>
    </tr>
    <tr>
      <td class='line'>51</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@GetMapping(path = "maintenancePersonnelsList")</pre></td>
    </tr>
    <tr>
      <td class='line'>52</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	String list(Model model) {</pre></td>
    </tr>
    <tr>
      <td class='line'>53</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		List&lt;MaintenancePersonnel> persons;</pre></td>
    </tr>
    <tr>
      <td class='line'>54</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l54s0'>		List&lt;PersonalForm> forms = new ArrayList&lt;>();</pre></td>
    </tr>
    <tr>
      <td class='line'>55</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l55s0'>		persons = maintenancePersonnelService.findAll();</pre></td>
    </tr>
    <tr>
      <td class='line'>56</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		PersonalForm form;</pre></td>
    </tr>
    <tr>
      <td class='line'>57</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l57s0' title='Executions: 0' class='uncovered'>for (MaintenancePersonnel person</span> : <span id='l57s1' title='Executions: 0' class='uncovered'>persons)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>58</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l58s0'>			form = new PersonalForm();</pre></td>
    </tr>
    <tr>
      <td class='line'>59</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l59s0'>			BeanUtils.copyProperties(person, form);</pre></td>
    </tr>
    <tr>
      <td class='line'>60</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l60s0'>			form.setRoleName(codeRoleService.findOne(form.getRoleId()).getRoleName());</pre></td>
    </tr>
    <tr>
      <td class='line'>61</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l61s0'>			forms.add(form);</pre></td>
    </tr>
    <tr>
      <td class='line'>62</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l62s0'>		}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>64</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l64s0'>		model.addAttribute("maintenancePersonnels", forms);</pre></td>
    </tr>
    <tr>
      <td class='line'>65</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l65s0'>		return StringConstant.Absolute_Path_maintenancePersonnelsList;</pre></td>
    </tr>
    <tr>
      <td class='line'>66</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>68</td><td>&nbsp;</td>
      <td><pre class='comment'>	// from listPage to createPage</pre></td>
    </tr>
    <tr>
      <td class='line'>69</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@GetMapping(path = "create") // , params = "renew_maintenancePersonnel")</pre></td>
    </tr>
    <tr>
      <td class='line'>70</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	String createMaintenancePersonnel(@RequestParam Integer id, PersonalForm form, Model model) {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>72</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l72s0'>		tool(id, form, model, StringConstant.Params_create);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>74</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l74s0'>		return StringConstant.Absolute_Path_editMaintenancePersonnel;</pre></td>
    </tr>
    <tr>
      <td class='line'>75</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>77</td><td>&nbsp;</td>
      <td><pre class='comment'>	// from listPage to editPage</pre></td>
    </tr>
    <tr>
      <td class='line'>78</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@GetMapping(path = "editMaintenancePersonnel")</pre></td>
    </tr>
    <tr>
      <td class='line'>79</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	String editMaintenancePersonnel(@RequestParam Integer id, PersonalForm form, Model model) {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>81</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l81s0'>		tool(id, form, model, StringConstant.Params_edit);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>83</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l83s0'>		return StringConstant.Absolute_Path_editMaintenancePersonnel;</pre></td>
    </tr>
    <tr>
      <td class='line'>84</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>86</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	void tool(Integer id, PersonalForm form, Model model, String settingCondition) {</pre></td>
    </tr>
    <tr>
      <td class='line'>87</td><td>&nbsp;</td>
      <td><pre class='comment'>		// æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã§å†åˆ©ç”¨ã™ã‚‹ã‹ã—ãªã?ã‹ã?®åˆ¤å®šã??IDãŒè¨­å®šã§å†åˆ©ç”¨ã•ã‚Œã¦ã?ã‚‹ã?‚æ–°è¦ã?®å ´åˆã?¯?¼ï¼‘ãŒè¨­å®šã•ã‚Œã¦ã?ã‚‹ã??</pre></td>
    </tr>
    <tr>
      <td class='line'>88</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l88s0' title='Executions: 0' class='uncovered'>if (id > 0)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>89</td><td>&nbsp;</td>
      <td><pre class='comment'>			// IDã‚ˆã‚Šãƒ¡ãƒ³ãƒ?ãƒŠãƒ³ã‚¹å“¡ã®æƒ?å ±ã‚’å–å¾—ã—ç”»é¢ãƒ•ã‚©ãƒ¼ãƒ?ã«è¨­å®?</pre></td>
    </tr>
    <tr>
      <td class='line'>90</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l90s0'>			MaintenancePersonnel person = maintenancePersonnelService.findOne(id);</pre></td>
    </tr>
    <tr>
      <td class='line'>91</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l91s0'>			BeanUtils.copyProperties(person, form);</pre></td>
    </tr>
    <tr>
      <td class='line'>92</td><td>&nbsp;</td>
      <td><pre class='comment'>			// é¸æŠã•ã‚ŒãŸãƒ¡ãƒ³ãƒ?ãƒŠãƒ³ã‚¹å“¡ã®å½¹å‰²åã‚’è¨­å®?</pre></td>
    </tr>
    <tr>
      <td class='line'>93</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l93s0'>			form.setRoleName(codeRoleService.findOne(form.getRoleId()).getRoleName());</pre></td>
    </tr>
    <tr>
      <td class='line'>94</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>95</td><td>&nbsp;</td>
      <td><pre class='comment'>		// æ–°è¦ä½œæ?ã?®ãŸã‚IDã‚’è¨­å®šã—ãªã?ã€‚ã“ã‚Œã‚’ã‚‚ã£ã¦æ–°è¦ä½œæ?ç”»é¢ã¨æ›´æ–°ç”»é¢ã‚’å??ã‚Šæ›¿ãˆã‚‹</pre></td>
    </tr>
    <tr>
      <td class='line'>96</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l96s0' title='Executions: 0' class='uncovered'>if (settingCondition.equals(StringConstant.Params_create))</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>97</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l97s0'>			form.setId(null);</pre></td>
    </tr>
    <tr>
      <td class='line'>98</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>99</td><td>&nbsp;</td>
      <td><pre class='comment'>		// DBã‚ˆã‚Šå½¹å‰²ãƒ?ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ç”»é¢ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆéƒ¨å“ç”¨ã®å½¹å‰²ãƒ•ã‚©ãƒ¼ãƒ?ä½œã‚Šã€ãƒ¢ãƒ?ãƒ«ã¸è¿½åŠ?</pre></td>
    </tr>
    <tr>
      <td class='line'>100</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l100s0'>		List&lt;CodeRole> codeRoles = codeRoleService.findAll();</pre></td>
    </tr>
    <tr>
      <td class='line'>101</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		SelectFormForRole roleForm;</pre></td>
    </tr>
    <tr>
      <td class='line'>102</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l102s0'>		List&lt;SelectFormForRole> roleForms = new ArrayList&lt;>();</pre></td>
    </tr>
    <tr>
      <td class='line'>103</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l103s0' title='Executions: 0' class='uncovered'>for (CodeRole codeRole</span> : <span id='l103s1' title='Executions: 0' class='uncovered'>codeRoles)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>104</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l104s0'>			roleForm = new SelectFormForRole();</pre></td>
    </tr>
    <tr>
      <td class='line'>105</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l105s0'>			BeanUtils.copyProperties(codeRole, roleForm);</pre></td>
    </tr>
    <tr>
      <td class='line'>106</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l106s0'>			roleForms.add(roleForm);</pre></td>
    </tr>
    <tr>
      <td class='line'>107</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l107s0'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>108</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l108s0'>		model.addAttribute("selectRole", roleForms);</pre></td>
    </tr>
    <tr>
      <td class='line'>109</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l109s0'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>111</td><td>&nbsp;</td>
      <td><pre class='comment'>	// insert data to DB</pre></td>
    </tr>
    <tr>
      <td class='line'>112</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@PostMapping(path = "editMaintenancePersonnel", params = "create")</pre></td>
    </tr>
    <tr>
      <td class='line'>113</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	String create(@RequestParam Integer id, @Validated PersonalForm form, BindingResult result,</pre></td>
    </tr>
    <tr>
      <td class='line'>114</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>			@AuthenticationPrincipal LoginUserDetails userDetails, Model model) {</pre></td>
    </tr>
    <tr>
      <td class='line'>115</td><td>&nbsp;</td>
      <td><pre class='comment'>		// è¨­å®šåˆ¤å®?</pre></td>
    </tr>
    <tr>
      <td class='line'>116</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l116s0' title='Executions: 0' class='uncovered'>if (form.getUseMailF())</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>117</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l117s0'>			form.setUserName(form.getMailaddress());</pre></td>
    </tr>
    <tr>
      <td class='line'>118</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>119</td><td>&nbsp;</td>
      <td><pre class='comment'>		// IDã®å­˜åœ¨ãƒã‚§ãƒ?ã‚¯</pre></td>
    </tr>
    <tr>
      <td class='line'>120</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l120s0' title='Executions: 0' class='uncovered'>if (userService.exists(form.getUserName()))</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>121</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l121s0'>			ObjectError arg0 = new ObjectError("userName", form.getUserName() + "ã®IDãŒæ—¢ã«å­˜åœ¨ã™ã‚‹");</pre></td>
    </tr>
    <tr>
      <td class='line'>122</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l122s0'>			result.addError(arg0);</pre></td>
    </tr>
    <tr>
      <td class='line'>123</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>124</td><td>&nbsp;</td>
      <td><pre class='comment'>		// IDã®æ–?å­—æ•°ãƒã‚§ãƒ?ã‚¯</pre></td>
    </tr>
    <tr>
      <td class='line'>125</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l125s0' title='Executions: 0' class='uncovered'>if (form.getUserName().length() &lt; 4)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>126</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l126s0'>			ObjectError arg0 = new ObjectError("userName", "ãƒ¦ãƒ¼ã‚¶åã?®æ–?å­—æ•°ãŒçŸ­ã?ã€?");</pre></td>
    </tr>
    <tr>
      <td class='line'>127</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l127s0'>			result.addError(arg0);</pre></td>
    </tr>
    <tr>
      <td class='line'>128</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>129</td><td>&nbsp;</td>
      <td><pre class='comment'>		// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã?®ãƒã‚§ãƒ?ã‚¯</pre></td>
    </tr>
    <tr>
      <td class='line'>130</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l130s0' title='Executions: 0' class='uncovered'>if (form.getPassword().length() &lt; 7)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>131</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l131s0'>			ObjectError arg0 = new ObjectError("password", "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã?®æ–?å­—æ•°ãŒçŸ­ã?ã€?");</pre></td>
    </tr>
    <tr>
      <td class='line'>132</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l132s0'>			result.addError(arg0);</pre></td>
    </tr>
    <tr>
      <td class='line'>133</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>134</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l134s0' title='Executions: 0' class='uncovered'>if (result.hasErrors())</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>135</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l135s0'>			return createMaintenancePersonnel(id, form, model);</pre></td>
    </tr>
    <tr>
      <td class='line'>136</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>138</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l138s0'>		String encdePassword = securityConfig.passwordEncoder().encode(form.getPassword());</pre></td>
    </tr>
    <tr>
      <td class='line'>139</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l139s0'>		User user = new User(form.getUserName(), encdePassword);</pre></td>
    </tr>
    <tr>
      <td class='line'>140</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l140s0'>		form.setPassword("");</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>142</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l142s0'>		MaintenancePersonnel maintenancePersonnel = new MaintenancePersonnel();</pre></td>
    </tr>
    <tr>
      <td class='line'>143</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l143s0'>		BeanUtils.copyProperties(form, maintenancePersonnel);</pre></td>
    </tr>
    <tr>
      <td class='line'>144</td><td>&nbsp;</td>
      <td><pre class='comment'>		// åˆ©ç”¨ãƒ•ãƒ©ã‚°ãŒfalseã§ãƒ¦ãƒ¼ã‚¶ãƒ?ãƒ¼ãƒ–ãƒ«ã®ãƒ?ãƒ¼ã‚¿ã‚’ç™»éŒ²</pre></td>
    </tr>
    <tr>
      <td class='line'>145</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l145s0' title='Executions: 0' class='uncovered'>if (!form.getDelF())</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>146</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l146s0'>			userService.create(user);</pre></td>
    </tr>
    <tr>
      <td class='line'>147</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>148</td><td>&nbsp;</td>
      <td><pre class='comment'>		// æ–°è¦ç™»éŒ²ã®ãŸã‚Nullã‚’ã‚»ãƒ?ãƒˆã?‚å‚ç…§ä½œæ?ç”¨</pre></td>
    </tr>
    <tr>
      <td class='line'>149</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l149s0'>		maintenancePersonnel.setId(null);</pre></td>
    </tr>
    <tr>
      <td class='line'>150</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l150s0'>		maintenancePersonnelService.create(maintenancePersonnel, userDetails.getUser());</pre></td>
    </tr>
    <tr>
      <td class='line'>151</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l151s0'>		return StringConstant.Redirect_Path_maintenancePersonnelsList;</pre></td>
    </tr>
    <tr>
      <td class='line'>152</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>154</td><td>&nbsp;</td>
      <td><pre class='comment'>	// update data to DB</pre></td>
    </tr>
    <tr>
      <td class='line'>155</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@PostMapping(path = "editMaintenancePersonnel", params = "edit")</pre></td>
    </tr>
    <tr>
      <td class='line'>156</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	String edit(@RequestParam Integer id, @Validated PersonalForm form, BindingResult result,</pre></td>
    </tr>
    <tr>
      <td class='line'>157</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>			@AuthenticationPrincipal LoginUserDetails userDetails, Model model) {</pre></td>
    </tr>
    <tr>
      <td class='line'>158</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l158s0'>		MaintenancePersonnel oldMaintenancePersonnel = maintenancePersonnelService.findOne(id);</pre></td>
    </tr>
    <tr>
      <td class='line'>159</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l159s0'>		User oldUser = userService.findOne(oldMaintenancePersonnel.getUserName());</pre></td>
    </tr>
    <tr>
      <td class='line'>160</td><td>&nbsp;</td>
      <td><pre class='comment'>		// è¨­å®šåˆ¤å®?</pre></td>
    </tr>
    <tr>
      <td class='line'>161</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l161s0' title='Executions: 0' class='uncovered'>if (form.getUseMailF())</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>162</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l162s0'>			form.setUserName(form.getMailaddress());</pre></td>
    </tr>
    <tr>
      <td class='line'>163</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>164</td><td>&nbsp;</td>
      <td><pre class='comment'>		// IDã®å­˜åœ¨ãƒã‚§ãƒ?ã‚¯</pre></td>
    </tr>
    <tr>
      <td class='line'>165</td><td>&nbsp;</td>
      <td><pre class='comment'>		// if (userService.notExists(form.getUserName())) {</pre></td>
    </tr>
    <tr>
      <td class='line'>166</td><td>&nbsp;</td>
      <td><pre class='comment'>		// ObjectError arg0 = new ObjectError("userName", form.getUserName() +</pre></td>
    </tr>
    <tr>
      <td class='line'>167</td><td>&nbsp;</td>
      <td><pre class='comment'>		// "ã®IDãŒå­˜åœ¨ã—ãªã?");</pre></td>
    </tr>
    <tr>
      <td class='line'>168</td><td>&nbsp;</td>
      <td><pre class='comment'>		// result.addError(arg0);</pre></td>
    </tr>
    <tr>
      <td class='line'>169</td><td>&nbsp;</td>
      <td><pre class='comment'>		// }</pre></td>
    </tr>
    <tr>
      <td class='line'>170</td><td>&nbsp;</td>
      <td><pre class='comment'>		// IDã®æ–?å­—æ•°ãƒã‚§ãƒ?ã‚¯</pre></td>
    </tr>
    <tr>
      <td class='line'>171</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l171s0' title='Executions: 0' class='uncovered'>if (form.getUserName().length() &lt; 4)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>172</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l172s0'>			ObjectError arg0 = new ObjectError("userName", "ãƒ¦ãƒ¼ã‚¶åã?®æ–?å­—æ•°ãŒçŸ­ã?ã€?");</pre></td>
    </tr>
    <tr>
      <td class='line'>173</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l173s0'>			result.addError(arg0);</pre></td>
    </tr>
    <tr>
      <td class='line'>174</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>175</td><td>&nbsp;</td>
      <td><pre class='comment'>		// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã?®ãƒã‚§ãƒ?ã‚¯</pre></td>
    </tr>
    <tr>
      <td class='line'>176</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l176s0' title='Executions: 0' class='uncovered'>if (form.getPassword().length() > 1</span> && <span id='l176s1' title='Executions: 0' class='uncovered'>form.getPassword().length() &lt; 7)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>177</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l177s0'>			ObjectError arg0 = new ObjectError("password", "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã?®æ–?å­—æ•°ãŒçŸ­ã?ã€?");</pre></td>
    </tr>
    <tr>
      <td class='line'>178</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l178s0'>			result.addError(arg0);</pre></td>
    </tr>
    <tr>
      <td class='line'>179</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>180</td><td>&nbsp;</td>
      <td><pre class='comment'>		// åˆ©ç”¨åœæ­¢ã‚ˆã‚Šå¾©æ´»ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã—ã‚’ã‚¨ãƒ©ãƒ¼ã¨ã™ã‚‹</pre></td>
    </tr>
    <tr>
      <td class='line'>181</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l181s0' title='Executions: 0' class='uncovered'>if (!form.getDelF()</span> && <span id='l181s1' title='Executions: 0' class='uncovered'>oldMaintenancePersonnel.getDelF()</span> && <span id='l181s2' title='Executions: 0' class='uncovered'>form.getPassword().length() &lt; 1)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>182</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l182s0'>			ObjectError arg0 = new ObjectError("password", "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã?®æ–?å­—æ•°ãŒçŸ­ã?ã€?");</pre></td>
    </tr>
    <tr>
      <td class='line'>183</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l183s0'>			result.addError(arg0);</pre></td>
    </tr>
    <tr>
      <td class='line'>184</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>185</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l185s0' title='Executions: 0' class='uncovered'>if (result.hasErrors())</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>186</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l186s0'>			return editMaintenancePersonnel(id, form, model);</pre></td>
    </tr>
    <tr>
      <td class='line'>187</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>189</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		String encdePassword;</pre></td>
    </tr>
    <tr>
      <td class='line'>190</td><td>&nbsp;</td>
      <td><pre class='comment'>		// 8æ–?å­—ä»¥ä¸Šã?®ãƒã‚§ãƒ?ã‚¯å¾Œã«0æ–?å­—ã?®æ™‚ã«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã?¯æ›´æ–°ã—ãªã?ã€?</pre></td>
    </tr>
    <tr>
      <td class='line'>191</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l191s0' title='Executions: 0' class='uncovered'>if (form.getPassword().trim().length() == 0)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>192</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l192s0'>			encdePassword = oldUser.getEncodedPassword();</pre></td>
    </tr>
    <tr>
      <td class='line'>193</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		} else {</pre></td>
    </tr>
    <tr>
      <td class='line'>194</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l194s0'>			encdePassword = securityConfig.passwordEncoder().encode(form.getPassword());</pre></td>
    </tr>
    <tr>
      <td class='line'>195</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>197</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l197s0'>		User user = new User(form.getUserName(), encdePassword);</pre></td>
    </tr>
    <tr>
      <td class='line'>198</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l198s0'>		form.setPassword("");</pre></td>
    </tr>
    <tr>
      <td class='line'>199</td><td>&nbsp;</td>
      <td><pre class='comment'>		// ãƒ¦ãƒ¼ã‚¶åã‚’å¤‰æ›´ã•ã‚Œã¦ã?ãŸå?´åˆã?ãƒ¦ãƒ¼ã‚¶ãƒ?ãƒ¼ãƒ–ãƒ«ã®æ—¢å­˜ã‚’å‰Šé™¤ã™ã‚‹ã€?</pre></td>
    </tr>
    <tr>
      <td class='line'>200</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l200s0' title='Executions: 0' class='uncovered'>if (!form.getUserName().equals(oldUser.getUsername()))</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>201</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l201s0'>			userService.delete(oldUser.getUsername());</pre></td>
    </tr>
    <tr>
      <td class='line'>202</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr>
      <td class='line'>203</td><td>&nbsp;</td>
      <td><pre class='comment'>		// åˆ©ç”¨åœæ­¢ã§ãƒ¦ãƒ¼ã‚¶ãƒ?ãƒ¼ãƒ–ãƒ«ã®ãƒ?ãƒ¼ã‚¿ã‚’å‰Šé™¤ã€‚é•ã?ãªã‚‰æ–°è¦ãƒ¦ãƒ¼ã‚¶ã‚’ç™»éŒ²</pre></td>
    </tr>
    <tr>
      <td class='line'>204</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>		<span id='l204s0' title='Executions: 0' class='uncovered'>if (form.getDelF())</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>205</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>			<span id='l205s0' title='Executions: 0' class='uncovered'>if (userService.exists(oldUser.getUsername()))</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>206</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l206s0'>				userService.delete(oldUser.getUsername());</pre></td>
    </tr>
    <tr>
      <td class='line'>207</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>			}</pre></td>
    </tr>
    <tr>
      <td class='line'>208</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		} else {</pre></td>
    </tr>
    <tr>
      <td class='line'>209</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l209s0'>			userService.update(user);</pre></td>
    </tr>
    <tr>
      <td class='line'>210</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>		}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>212</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l212s0'>		MaintenancePersonnel maintenancePersonnel = new MaintenancePersonnel();</pre></td>
    </tr>
    <tr>
      <td class='line'>213</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l213s0'>		BeanUtils.copyProperties(form, maintenancePersonnel);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>215</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l215s0'>		maintenancePersonnelService.update(maintenancePersonnel, userDetails.getUser());</pre></td>
    </tr>
    <tr>
      <td class='line'>216</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l216s0'>		return StringConstant.Redirect_Path_maintenancePersonnelsList;</pre></td>
    </tr>
    <tr>
      <td class='line'>217</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>219</td><td>&nbsp;</td>
      <td><pre class='comment'>	// from workPage to PreviousPage</pre></td>
    </tr>
    <tr>
      <td class='line'>220</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@PostMapping(path = "editMaintenancePersonnel", params = StringConstant.Params_goToBack)</pre></td>
    </tr>
    <tr>
      <td class='line'>221</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	String goToPrevious() {</pre></td>
    </tr>
    <tr>
      <td class='line'>222</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l222s0'>		return StringConstant.Redirect_Path_maintenancePersonnelsList;</pre></td>
    </tr>
    <tr>
      <td class='line'>223</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>225</td><td>&nbsp;</td>
      <td><pre class='comment'>	// from listPage to PreviousPage</pre></td>
    </tr>
    <tr>
      <td class='line'>226</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	@PostMapping(path = "maintenancePersonnelsList", params = StringConstant.Params_goToBack)</pre></td>
    </tr>
    <tr>
      <td class='line'>227</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	String goToPrevious2() {</pre></td>
    </tr>
    <tr>
      <td class='line'>228</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l228s0'>		return StringConstant.Redirect_Path_newsOperation;</pre></td>
    </tr>
    <tr>
      <td class='line'>229</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>	}</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>231</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>}</pre></td>
    </tr>
  </table>
</body>
</html>
